{% extends 'base.html' %}
{% load static %}
{% load i18n %}

{% block title %}{% trans "تحرير المستند" %} - {{ document.title }}{% endblock %}

{% block extra_css %}
<link rel="stylesheet" href="{% static 'style/create.css' %}" />
{% endblock %}

{% block content %}
<!-- Page Title Section -->
<section class="page-title">
  <div class="container">
    <h1 class="animate fade-in">{% trans "تحرير المستند" %}</h1>
    <div class="breadcrumb animate fade-in delay-100">
      <a href="{% url 'core:index' %}">{% trans "الرئيسية" %}</a> / 
      <a href="{% url 'documents:drafts' %}">{% trans "المسودات" %}</a> / 
      <span>{% trans "تحرير" %} {{ document.title }}</span>
    </div>
  </div>
  <div class="floating-circle large"></div>
  <div class="floating-circle medium"></div>
</section>

<!-- Document Edit Form Section -->
<section class="create-notebook">
  <div class="container">
    <div class="form-container">
      <h2>{% trans "تحرير المستند" %}</h2>
      <form id="edit-form" method="post" action="{% url 'documents:document_edit' document.id %}">
        {% csrf_token %}
        
        {% if form.non_field_errors %}
          <div class="error-message">
            {% for error in form.non_field_errors %}
              {{ error }}
            {% endfor %}
          </div>
        {% endif %}
        
        <div class="form-group">
          <label for="id_title">{% trans "عنوان المستند:" %}</label>
          <input
            type="text"
            id="id_title"
            name="title"
            value="{{ form.title.value|default:document.title }}"
            placeholder="{% trans 'أدخل عنوان المستند' %}"
            required
          />
          {% if form.title.errors %}
            <div class="error-message">
              {% for error in form.title.errors %}
                {{ error }}
              {% endfor %}
            </div>
          {% endif %}
        </div>

        <div class="form-group">
          <label for="id_status">{% trans "حالة المستند:" %}</label>
          <select id="id_status" name="status">
            <option value="active" {% if document.status == 'active' %}selected{% endif %}>{% trans "نشط" %}</option>
            <option value="completed" {% if document.status == 'completed' %}selected{% endif %}>{% trans "مكتمل" %}</option>
            <option value="archived" {% if document.status == 'archived' %}selected{% endif %}>{% trans "مؤرشف" %}</option>
            <option value="pending" {% if document.status == 'pending' %}selected{% endif %}>{% trans "قيد المراجعة" %}</option>
          </select>
          {% if form.status.errors %}
            <div class="error-message">
              {% for error in form.status.errors %}
                {{ error }}
              {% endfor %}
            </div>
          {% endif %}
        </div>

        <div class="form-group">
          <label for="id_description">{% trans "وصف المستند:" %}</label>
          <textarea
            id="id_description"
            name="description"
            rows="4"
            placeholder="{% trans 'أدخل وصف المستند' %}"
            required
          >{{ form.description.value|default:document.description }}</textarea>
          {% if form.description.errors %}
            <div class="error-message">
              {% for error in form.description.errors %}
                {{ error }}
              {% endfor %}
            </div>
          {% endif %}
        </div>

        <div class="form-group">
          <label for="id_content">{% trans "محتوى المستند:" %}</label>
          <textarea
            id="id_content"
            name="content"
            rows="12"
            placeholder="{% trans 'أدخل محتوى المستند' %}"
            required
          >{{ form.content.value|default:document.content }}</textarea>
          {% if form.content.errors %}
            <div class="error-message">
              {% for error in form.content.errors %}
                {{ error }}
              {% endfor %}
            </div>
          {% endif %}
        </div>

        <div class="form-actions">
          <button type="submit" class="btn btn-primary">
            <span class="btn-text">{% trans "حفظ التغييرات" %}</span>
          </button>
          <a href="{% url 'documents:document_detail' document.id %}" class="btn btn-outline">
            {% trans "إلغاء" %}
          </a>
        </div>
      </form>
    </div>
  </div>
  <div class="floating-circle small"></div>
</section>
{% endblock %}

{% block extra_js %}
<script src="{% static 'js/document-edit.js' %}"></script>
{% endblock %}